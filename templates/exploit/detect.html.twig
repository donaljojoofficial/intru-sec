{% block body %}
<h1>IntruNex: Web Exploit Detection</h1>
<form id="scan-form" method="post" action="{{ path('detect_exploit') }}">
    <input type="text" name="url" id="url-input" placeholder="Enter URL to scan" required>
    <button type="submit">Scan</button>
</form>

<div id="results" style="margin-top:20px;"></div>
<script>
document.getElementById('scan-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const url = document.getElementById('url-input').value;
    const response = await fetch('{{ path('detect_exploit') }}', {
        method: 'POST',
        body: new URLSearchParams({url: url})
    });
    const data = await response.json();
    let html = '<h2>Scan Results:</h2><ul>';
    data.types.forEach(type => {
        if(type === 'Safe') {
            html += '<li style="color:green;">Safe</li>';
        } else {
            html += '<li style="color:red;">' + type + '</li>';
        }
    });
    html += '</ul>';
    document.getElementById('results').innerHTML = html;
});
</script>
{% endblock %}
